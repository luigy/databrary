<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, RecordWildCards #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">HTTP</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier hs-type">FormPath</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formPathText"><span class="hs-identifier hs-var">formPathText</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-type">FormData</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#initForm"><span class="hs-identifier hs-var">initForm</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#subForm"><span class="hs-identifier hs-var">subForm</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#subForms"><span class="hs-identifier hs-var">subForms</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSC</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashMap</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HM</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TE</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network</span><span class="hs-operator">.</span><span class="hs-identifier">Wai</span><span class="hs-operator">.</span><span class="hs-identifier">Parse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FileInfo</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Has.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Has</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Has.html#Has"><span class="hs-identifier hs-type">Has</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-HTTP-Form-Data.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">HTTP</span><span class="hs-operator">.</span><span class="hs-identifier">Form</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">data</span><span> </span><a name="FormKey"><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier">FormKey</span></a></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="FormField"><a href="Databrary.HTTP.Form.html#FormField"><span class="hs-identifier">FormField</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FormIndex"><a href="Databrary.HTTP.Form.html#FormIndex"><span class="hs-identifier">FormIndex</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="FormPath"><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier">FormPath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span class="hs-special">]</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-identifier">formSubPath</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier hs-type">FormPath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier hs-type">FormPath</span></a><span>
</span><a name="line-36"></a><a name="formSubPath"><a href="Databrary.HTTP.Form.html#formSubPath"><span class="hs-identifier">formSubPath</span></a></a><span> </span><a name="local-1627688026"><a href="#local-1627688026"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627688027"><a href="#local-1627688027"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688027"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-1627688026"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">instance</span><span> </span><a href="Databrary.Has.html#Has"><span class="hs-identifier hs-type">Has</span></a><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>  </span><a name="local-1912872322"><a href="Databrary.Has.html#view"><span class="hs-identifier">view</span></a></a><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormField"><span class="hs-identifier hs-var">FormField</span></a><span> </span><a name="local-1627688072"><a href="#local-1627688072"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">encodeUtf8</span><span> </span><a href="#local-1627688072"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-identifier">view</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormIndex"><span class="hs-identifier hs-var">FormIndex</span></a><span> </span><a name="local-1627688073"><a href="#local-1627688073"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1627688073"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">instance</span><span> </span><a href="Databrary.Has.html#Has"><span class="hs-identifier hs-type">Has</span></a><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-43"></a><span>  </span><a name="local-1912872322"><a href="Databrary.Has.html#view"><span class="hs-identifier">view</span></a></a><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormField"><span class="hs-identifier hs-var">FormField</span></a><span> </span><a name="local-1627688070"><a href="#local-1627688070"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688070"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-identifier">view</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormIndex"><span class="hs-identifier hs-var">FormIndex</span></a><span> </span><a name="local-1627688071"><a href="#local-1627688071"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1627688071"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-identifier">dotsBS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-47"></a><a name="dotsBS"><a href="Databrary.HTTP.Form.html#dotsBS"><span class="hs-identifier">dotsBS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><span class="hs-char">'.'</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-identifier">dotBS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-50"></a><a name="dotBS"><a href="Databrary.HTTP.Form.html#dotBS"><span class="hs-identifier">dotBS</span></a></a><span> </span><a name="local-1627688028"><a href="#local-1627688028"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627688029"><a href="#local-1627688029"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-1627688028"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688029"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#dotsBS"><span class="hs-identifier hs-var">dotsBS</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627688028"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627688029"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">formSubBS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-55"></a><a name="formSubBS"><a href="Databrary.HTTP.Form.html#formSubBS"><span class="hs-identifier">formSubBS</span></a></a><span> </span><a name="local-1627688030"><a href="#local-1627688030"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627688031"><a href="#local-1627688031"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688031"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Databrary.HTTP.Form.html#dotBS"><span class="hs-identifier hs-var">dotBS</span></a><span class="hs-special">`</span><span> </span><a href="Databrary.Has.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><a href="#local-1627688030"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">formPathText</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier hs-type">FormPath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-58"></a><a name="formPathText"><a href="Databrary.HTTP.Form.html#formPathText"><span class="hs-identifier">formPathText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><span class="hs-char">'.'</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Databrary.Has.html#view"><span class="hs-identifier hs-var">view</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">data</span><span> </span><a name="FormDatum"><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier">FormDatum</span></a></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="FormDatumNone"><a href="Databrary.HTTP.Form.html#FormDatumNone"><span class="hs-identifier">FormDatumNone</span></a></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FormDatumBS"><a href="Databrary.HTTP.Form.html#FormDatumBS"><span class="hs-identifier">FormDatumBS</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FormDatumJSON"><a href="Databrary.HTTP.Form.html#FormDatumJSON"><span class="hs-identifier">FormDatumJSON</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FormDatumFlag"><a href="Databrary.HTTP.Form.html#FormDatumFlag"><span class="hs-identifier">FormDatumFlag</span></a></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-68"></a><span>  </span><a name="local-1912604211"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatumNone"><span class="hs-identifier hs-var">FormDatumNone</span></a><span>
</span><a name="line-69"></a><span>  </span><a name="local-1912604212"><span class="hs-identifier">mappend</span></a><span> </span><a href="Databrary.HTTP.Form.html#FormDatumNone"><span class="hs-identifier hs-var">FormDatumNone</span></a><span> </span><a name="local-1627688068"><a href="#local-1627688068"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688068"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-identifier">mappend</span><span> </span><a name="local-1627688069"><a href="#local-1627688069"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688069"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">data</span><span> </span><a name="Form"><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier">Form</span></a></a><span> </span><a name="local-1627688014"><a href="#local-1627688014"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Form"><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier">Form</span></a></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="formData"><a href="Databrary.HTTP.Form.html#formData"><span class="hs-identifier">formData</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-type">FormData</span></a><span> </span><a href="#local-1627688014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="formPath"><a href="Databrary.HTTP.Form.html#formPath"><span class="hs-identifier">formPath</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormPath"><span class="hs-identifier hs-type">FormPath</span></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="formPathBS"><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier">formPathBS</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="formJSON"><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier">formJSON</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span>
</span><a name="line-77"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="formDatum"><a href="Databrary.HTTP.Form.html#formDatum"><span class="hs-identifier">formDatum</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="formFile"><a href="Databrary.HTTP.Form.html#formFile"><span class="hs-identifier">formFile</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FileInfo</span><span> </span><a href="#local-1627688014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- makeHasRec ''Form ['formData, 'formPath, 'formPathBS, 'formDatum, 'formFile]</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">initForm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-type">FormData</span></a><span> </span><a href="#local-1627688025"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688025"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-84"></a><a name="initForm"><a href="Databrary.HTTP.Form.html#initForm"><span class="hs-identifier">initForm</span></a></a><span> </span><a name="local-1627688032"><a href="#local-1627688032"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688033"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-1627688033"><a href="#local-1627688033"><span class="hs-identifier">form</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-var">Form</span></a><span> </span><a href="#local-1627688032"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.Data.html#formDataJSON"><span class="hs-identifier hs-var">formDataJSON</span></a><span> </span><a href="#local-1627688032"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#getFormDatum"><span class="hs-identifier hs-var">getFormDatum</span></a><span> </span><a href="#local-1627688033"><span class="hs-identifier hs-var">form</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-identifier">formSubJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span>
</span><a name="line-87"></a><a name="formSubJSON"><a href="Databrary.HTTP.Form.html#formSubJSON"><span class="hs-identifier">formSubJSON</span></a></a><span> </span><a name="local-1627688034"><a href="#local-1627688034"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Object</span><span> </span><a name="local-1627688035"><a href="#local-1627688035"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><a href="Databrary.Has.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><a href="#local-1627688034"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627688035"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-88"></a><span class="hs-identifier">formSubJSON</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormIndex"><span class="hs-identifier hs-var">FormIndex</span></a><span> </span><a name="local-1627688036"><a href="#local-1627688036"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Array</span><span> </span><a name="local-1627688037"><a href="#local-1627688037"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688037"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.!?</span><span> </span><a href="#local-1627688036"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-89"></a><span class="hs-identifier">formSubJSON</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-identifier">subForm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688024"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-92"></a><a name="subForm"><a href="Databrary.HTTP.Form.html#subForm"><span class="hs-identifier">subForm</span></a></a><span> </span><a name="local-1627688038"><a href="#local-1627688038"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-1627688039"><a href="#local-1627688039"><span class="hs-identifier">form</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688040"><span class="hs-identifier hs-var">form'</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-93"></a><span>  </span><a name="local-1627688040"><a href="#local-1627688040"><span class="hs-identifier">form'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688039"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formPath"><span class="hs-identifier hs-var">formPath</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#formSubPath"><span class="hs-identifier hs-var">formSubPath</span></a><span> </span><a href="#local-1627688038"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Databrary.HTTP.Form.html#formPath"><span class="hs-identifier hs-var">formPath</span></a><span> </span><a href="#local-1627688039"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#formSubBS"><span class="hs-identifier hs-var">formSubBS</span></a><span> </span><a href="#local-1627688038"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><a href="#local-1627688039"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier hs-var">formJSON</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#formSubJSON"><span class="hs-identifier hs-var">formSubJSON</span></a><span> </span><a href="#local-1627688038"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier hs-var">formJSON</span></a><span> </span><a href="#local-1627688039"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formDatum"><span class="hs-identifier hs-var">formDatum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#getFormDatum"><span class="hs-identifier hs-var">getFormDatum</span></a><span> </span><a href="#local-1627688040"><span class="hs-identifier hs-var">form'</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formFile"><span class="hs-identifier hs-var">formFile</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#getFormFile"><span class="hs-identifier hs-var">getFormFile</span></a><span> </span><a href="#local-1627688040"><span class="hs-identifier hs-var">form'</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">jsonSubForms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688023"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688023"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-102"></a><a name="jsonSubForms"><a href="Databrary.HTTP.Form.html#jsonSubForms"><span class="hs-identifier">jsonSubForms</span></a></a><span> </span><a name="local-1627688041"><a href="#local-1627688041"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1627688042"><span class="hs-identifier hs-var">jfk</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier hs-var">formJSON</span></a><span> </span><a href="#local-1627688041"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-103"></a><span>  </span><a name="local-1627688042"><a href="#local-1627688042"><span class="hs-identifier">jfk</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Array</span><span> </span><a name="local-1627688044"><a href="#local-1627688044"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">imap</span><span> </span><span class="hs-special">(</span><a href="#local-1627688043"><span class="hs-identifier hs-var">sfj</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Databrary.HTTP.Form.html#FormIndex"><span class="hs-identifier hs-var">FormIndex</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627688044"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-identifier">jfk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Object</span><span> </span><a name="local-1627688045"><a href="#local-1627688045"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapWithKey</span><span> </span><span class="hs-special">(</span><a href="#local-1627688043"><span class="hs-identifier hs-var">sfj</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Databrary.HTTP.Form.html#FormField"><span class="hs-identifier hs-var">FormField</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627688045"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-identifier">jfk</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span>  </span><a name="local-1627688043"><a href="#local-1627688043"><span class="hs-identifier">sfj</span></a></a><span> </span><a name="local-1627688046"><a href="#local-1627688046"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627688047"><a href="#local-1627688047"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627688046"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#subForm"><span class="hs-identifier hs-var">subForm</span></a><span> </span><a href="#local-1627688046"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627688041"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier hs-var">formJSON</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1627688047"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formDatum"><span class="hs-identifier hs-var">formDatum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatumJSON"><span class="hs-identifier hs-var">FormDatumJSON</span></a><span> </span><a href="#local-1627688047"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-identifier">subFormsFor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-type">FormData</span></a><span> </span><a href="#local-1627688021"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span> </span><a href="#local-1627688022"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688021"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><a name="subFormsFor"><a href="Databrary.HTTP.Form.html#subFormsFor"><span class="hs-identifier">subFormsFor</span></a></a><span> </span><a name="local-1627688048"><a href="#local-1627688048"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627688049"><a href="#local-1627688049"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-1627688050"><span class="hs-identifier hs-var">sf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Databrary.HTTP.Form.html#FormField"><span class="hs-identifier hs-var">FormField</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">TE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">decodeUtf8</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627688053"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-char">'.'</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">BS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-1627688052"><span class="hs-identifier hs-var">l'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPrefixOf</span><span> </span><a href="#local-1627688051"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">split</span><span> </span><a href="#local-1627688051"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627688048"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Databrary.HTTP.Form.html#formData"><span class="hs-identifier hs-var">formData</span></a><span> </span><a href="#local-1627688049"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-111"></a><span>  </span><a name="local-1627688050"><a href="#local-1627688050"><span class="hs-identifier">sf</span></a></a><span> </span><a name="local-1627688054"><a href="#local-1627688054"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627688054"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#subForm"><span class="hs-identifier hs-var">subForm</span></a><span> </span><a href="#local-1627688054"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627688049"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>  </span><a name="local-1627688051"><a href="#local-1627688051"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><a href="#local-1627688049"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">`</span><a href="Databrary.HTTP.Form.html#dotBS"><span class="hs-identifier hs-var">dotBS</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-113"></a><span>  </span><a name="local-1627688052"><a href="#local-1627688052"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-1627688051"><span class="hs-identifier hs-var">p'</span></a><span>
</span><a name="line-114"></a><span>  </span><a name="local-1627688053"><a href="#local-1627688053"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627688055"><a href="#local-1627688055"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-1627688056"><a href="#local-1627688056"><span class="hs-identifier">bl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1627688057"><a href="#local-1627688057"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627688055"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627688057"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688053"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627688056"><span class="hs-identifier hs-var">bl</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688055"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627688053"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-1627688056"><span class="hs-identifier hs-var">bl</span></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-identifier">uniq</span><span> </span><a name="local-1627688058"><a href="#local-1627688058"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627688058"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">subForms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688020"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Databrary.HTTP.Form.html#FormKey"><span class="hs-identifier hs-type">FormKey</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688020"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-120"></a><a name="subForms"><a href="Databrary.HTTP.Form.html#subForms"><span class="hs-identifier">subForms</span></a></a><span> </span><a name="local-1627688059"><a href="#local-1627688059"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#subFormsFor"><span class="hs-identifier hs-var">subFormsFor</span></a><span> </span><a href="Databrary.HTTP.Form.Data.html#formDataPost"><span class="hs-identifier hs-var">formDataPost</span></a><span> </span><a href="#local-1627688059"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Databrary.HTTP.Form.html#jsonSubForms"><span class="hs-identifier hs-var">jsonSubForms</span></a><span> </span><a href="#local-1627688059"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Databrary.HTTP.Form.html#subFormsFor"><span class="hs-identifier hs-var">subFormsFor</span></a><span> </span><a href="Databrary.HTTP.Form.Data.html#formDataQuery"><span class="hs-identifier hs-var">formDataQuery</span></a><span> </span><a href="#local-1627688059"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">jsonFormDatum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688019"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span>
</span><a name="line-123"></a><a name="jsonFormDatum"><a href="Databrary.HTTP.Form.html#jsonFormDatum"><span class="hs-identifier">jsonFormDatum</span></a></a><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-var">Form</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formJSON"><span class="hs-identifier hs-var">formJSON</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688060"><a href="#local-1627688060"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatumJSON"><span class="hs-identifier hs-var">FormDatumJSON</span></a><span> </span><a href="#local-1627688060"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">queryFormDatum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688018"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span>
</span><a name="line-126"></a><a name="queryFormDatum"><a href="Databrary.HTTP.Form.html#queryFormDatum"><span class="hs-identifier">queryFormDatum</span></a></a><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-var">Form</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formData"><span class="hs-identifier hs-var">formData</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-var">FormData</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.Data.html#formDataQuery"><span class="hs-identifier hs-var">formDataQuery</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688061"><a href="#local-1627688061"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688062"><a href="#local-1627688062"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatumFlag"><span class="hs-identifier hs-var">FormDatumFlag</span></a><span> </span><a href="Databrary.HTTP.Form.html#FormDatumBS"><span class="hs-identifier hs-var">FormDatumBS</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-1627688062"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1627688061"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-identifier">postFormDatum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688017"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span>
</span><a name="line-130"></a><a name="postFormDatum"><a href="Databrary.HTTP.Form.html#postFormDatum"><span class="hs-identifier">postFormDatum</span></a></a><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-var">Form</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formData"><span class="hs-identifier hs-var">formData</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-var">FormData</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.Data.html#formDataPost"><span class="hs-identifier hs-var">formDataPost</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688063"><a href="#local-1627688063"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688064"><a href="#local-1627688064"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-identifier hs-var">foldMap</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatumBS"><span class="hs-identifier hs-var">FormDatumBS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-1627688064"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1627688063"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">getFormDatum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688016"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#FormDatum"><span class="hs-identifier hs-type">FormDatum</span></a><span>
</span><a name="line-134"></a><a name="getFormDatum"><a href="Databrary.HTTP.Form.html#getFormDatum"><span class="hs-identifier">getFormDatum</span></a></a><span> </span><a name="local-1627688065"><a href="#local-1627688065"><span class="hs-identifier">form</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.html#postFormDatum"><span class="hs-identifier hs-var">postFormDatum</span></a><span> </span><a href="#local-1627688065"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#jsonFormDatum"><span class="hs-identifier hs-var">jsonFormDatum</span></a><span> </span><a href="#local-1627688065"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Databrary.HTTP.Form.html#queryFormDatum"><span class="hs-identifier hs-var">queryFormDatum</span></a><span> </span><a href="#local-1627688065"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-identifier">getFormFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-type">Form</span></a><span> </span><a href="#local-1627688015"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FileInfo</span><span> </span><a href="#local-1627688015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><a name="getFormFile"><a href="Databrary.HTTP.Form.html#getFormFile"><span class="hs-identifier">getFormFile</span></a></a><span> </span><a href="Databrary.HTTP.Form.html#Form"><span class="hs-identifier hs-var">Form</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.html#formData"><span class="hs-identifier hs-var">formData</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.HTTP.Form.Data.html#FormData"><span class="hs-identifier hs-var">FormData</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.HTTP.Form.Data.html#formDataFiles"><span class="hs-identifier hs-var">formDataFiles</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688066"><a href="#local-1627688066"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="Databrary.HTTP.Form.html#formPathBS"><span class="hs-identifier hs-var">formPathBS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627688067"><a href="#local-1627688067"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-1627688067"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1627688066"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-138"></a></pre></body></html>