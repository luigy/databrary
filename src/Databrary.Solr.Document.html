<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving, TemplateHaskell, OverloadedStrings #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Solr</span><span class="hs-operator">.</span><span class="hs-identifier">Document</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Databrary.Solr.Document.html#SolrDocument"><span class="hs-identifier hs-type">SolrDocument</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier hs-type">SolrRecordMeasures</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Databrary.Solr.Document.html#metricField"><span class="hs-identifier hs-var">metricField</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JTH</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAlphaNum</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Int</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int16</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashMap</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HM</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Id.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Id</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Permission.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Permission</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Release.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Release</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Party.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Party</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Volume.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Volume</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Container.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Container</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Offset.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Offset</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Segment.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Segment</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Format.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Format</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Asset.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Asset</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Time.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Age.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Age</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Record.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Category.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Category</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Metric.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Metric</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Tag.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Tag</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.Model.Comment.Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Comment</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Databrary.String.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">String</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-identifier">safeField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-38"></a><a name="safeField"><a href="Databrary.Solr.Document.html#safeField"><span class="hs-identifier">safeField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-1628718834"><span class="hs-identifier hs-var">safeChar</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>  </span><a name="local-1628718834"><a href="#local-1628718834"><span class="hs-identifier">safeChar</span></a></a><span> </span><a name="local-1628718835"><a href="#local-1628718835"><span class="hs-identifier">c</span></a></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isAlphaNum</span><span> </span><a href="#local-1628718835"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628718835"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'_'</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">newtype</span><span> </span><a name="SolrRecordMeasures"><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier">SolrRecordMeasures</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SolrRecordMeasures"><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier">SolrRecordMeasures</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-type">Metric</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureDatum"><span class="hs-identifier hs-type">MeasureDatum</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-identifier">metricLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-type">Metric</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-46"></a><a name="metricLabel"><a href="Databrary.Solr.Document.html#metricLabel"><span class="hs-identifier">metricLabel</span></a></a><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeText"><span class="hs-identifier hs-var">MeasureTypeText</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricOptions"><span class="hs-identifier hs-var">metricOptions</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;enum&quot;</span><span>
</span><a name="line-47"></a><span class="hs-identifier">metricLabel</span><span> </span><a name="local-1628718836"><a href="#local-1628718836"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">@</span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeText"><span class="hs-identifier hs-var">MeasureTypeText</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Databrary.Model.Metric.html#metricLong"><span class="hs-identifier hs-var">metricLong</span></a><span> </span><a href="#local-1628718836"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;long&quot;</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;text&quot;</span><span>
</span><a name="line-50"></a><span class="hs-identifier">metricLabel</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeNumeric"><span class="hs-identifier hs-var">MeasureTypeNumeric</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;numeric&quot;</span><span>
</span><a name="line-51"></a><span class="hs-identifier">metricLabel</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeDate"><span class="hs-identifier hs-var">MeasureTypeDate</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;date&quot;</span><span>
</span><a name="line-52"></a><span class="hs-identifier">metricLabel</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeVoid"><span class="hs-identifier hs-var">MeasureTypeVoid</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;void&quot;</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">metricField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-type">Metric</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-55"></a><a name="metricField"><a href="Databrary.Solr.Document.html#metricField"><span class="hs-identifier">metricField</span></a></a><span> </span><a name="local-1628718837"><a href="#local-1628718837"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;record_&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Databrary.Solr.Document.html#metricLabel"><span class="hs-identifier hs-var">metricLabel</span></a><span> </span><a href="#local-1628718837"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-char">'_'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">cons</span><span class="hs-special">`</span><span> </span><a href="Databrary.Solr.Document.html#safeField"><span class="hs-identifier hs-var">safeField</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Metric.Types.html#metricName"><span class="hs-identifier hs-var">metricName</span></a><span> </span><a href="#local-1628718837"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- slight hack because we actually index dates as datetimes</span><span>
</span><a name="line-58"></a><span class="hs-identifier">metricDatum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-type">Metric</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureDatum"><span class="hs-identifier hs-type">MeasureDatum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span>
</span><a name="line-59"></a><a name="metricDatum"><a href="Databrary.Solr.Document.html#metricDatum"><span class="hs-identifier">metricDatum</span></a></a><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeDate"><span class="hs-identifier hs-var">MeasureTypeDate</span></a><span> </span><span class="hs-special">}</span><span> </span><a name="local-1628718838"><a href="#local-1628718838"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toJSON</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1628718838"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;T12:00:00Z&quot;</span><span>
</span><a name="line-60"></a><span class="hs-identifier">metricDatum</span><span> </span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-var">Metric</span></a><span class="hs-special">{</span><span> </span><a href="Databrary.Model.Metric.Types.html#metricType"><span class="hs-identifier hs-var">metricType</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureTypeVoid"><span class="hs-identifier hs-var">MeasureTypeVoid</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toJSON</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-61"></a><span class="hs-identifier">metricDatum</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628718839"><a href="#local-1628718839"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toJSON</span><span> </span><a href="#local-1628718839"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-identifier">measureKeyValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">KeyValue</span><span> </span><a href="#local-1628718833"><span class="hs-identifier hs-type">kv</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Metric.Types.html#Metric"><span class="hs-identifier hs-type">Metric</span></a><span class="hs-special">,</span><span> </span><a href="Databrary.Model.Metric.Types.html#MeasureDatum"><span class="hs-identifier hs-type">MeasureDatum</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628718833"><span class="hs-identifier hs-type">kv</span></a><span>
</span><a name="line-64"></a><a name="measureKeyValue"><a href="Databrary.Solr.Document.html#measureKeyValue"><span class="hs-identifier">measureKeyValue</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1628718840"><a href="#local-1628718840"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628718841"><a href="#local-1628718841"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Solr.Document.html#metricField"><span class="hs-identifier hs-var">metricField</span></a><span> </span><a href="#local-1628718840"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">..=</span><span> </span><a href="Databrary.Solr.Document.html#metricDatum"><span class="hs-identifier hs-var">metricDatum</span></a><span> </span><a href="#local-1628718840"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-1628718841"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier hs-type">SolrRecordMeasures</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-67"></a><span>  </span><a name="local-1912605484"><span class="hs-identifier">toJSON</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier hs-var">SolrRecordMeasures</span></a><span> </span><a name="local-1628718845"><a href="#local-1628718845"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">object</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Databrary.Solr.Document.html#measureKeyValue"><span class="hs-identifier hs-var">measureKeyValue</span></a><span> </span><a href="#local-1628718845"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-69"></a><span>  </span><a name="local-1912605483"><span class="hs-identifier">toEncoding</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier hs-var">SolrRecordMeasures</span></a><span> </span><a name="local-1628718846"><a href="#local-1628718846"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pairs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Databrary.Solr.Document.html#measureKeyValue"><span class="hs-identifier hs-var">measureKeyValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><a href="#local-1628718846"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">newtype</span><span> </span><a name="SolrSegment"><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier">SolrSegment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SolrSegment"><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier">SolrSegment</span></a></a><span> </span><a href="Databrary.Model.Segment.html#Segment"><span class="hs-identifier hs-type">Segment</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>  </span><a name="local-1912610714"><span class="hs-identifier">showsPrec</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-var">SolrSegment</span></a><span> </span><a name="local-1628718844"><a href="#local-1628718844"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Segment.html#showSegmentWith"><span class="hs-identifier hs-var">showSegmentWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Databrary.Model.Offset.html#offsetMillis"><span class="hs-identifier hs-var">offsetMillis</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628718844"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>  </span><a name="local-1912605484"><span class="hs-identifier">toJSON</span></a><span> </span><a name="local-1628718842"><a href="#local-1628718842"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">String</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1628718842"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-79"></a><span>  </span><a name="local-1912605483"><span class="hs-identifier">toEncoding</span></a><span> </span><a name="local-1628718843"><a href="#local-1628718843"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toEncoding</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1628718843"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">data</span><span> </span><a name="SolrDocument"><a href="Databrary.Solr.Document.html#SolrDocument"><span class="hs-identifier">SolrDocument</span></a></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="SolrParty"><a href="Databrary.Solr.Document.html#SolrParty"><span class="hs-identifier">SolrParty</span></a></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyId"><a href="Databrary.Solr.Document.html#solrPartyId"><span class="hs-identifier">solrPartyId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Party.Types.html#Party"><span class="hs-identifier hs-type">Party</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartySortName"><a href="Databrary.Solr.Document.html#solrPartySortName"><span class="hs-identifier">solrPartySortName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyPreName"><a href="Databrary.Solr.Document.html#solrPartyPreName"><span class="hs-identifier">solrPartyPreName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyAffiliation"><a href="Databrary.Solr.Document.html#solrPartyAffiliation"><span class="hs-identifier">solrPartyAffiliation</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyIsInstitution"><a href="Databrary.Solr.Document.html#solrPartyIsInstitution"><span class="hs-identifier">solrPartyIsInstitution</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyAuthorization"><a href="Databrary.Solr.Document.html#solrPartyAuthorization"><span class="hs-identifier">solrPartyAuthorization</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Permission.Types.html#Permission"><span class="hs-identifier hs-type">Permission</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrVolume"><a href="Databrary.Solr.Document.html#SolrVolume"><span class="hs-identifier">SolrVolume</span></a></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrName"><a href="Databrary.Solr.Document.html#solrName"><span class="hs-identifier">solrName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrBody"><a href="Databrary.Solr.Document.html#solrBody"><span class="hs-identifier">solrBody</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-comment">-- body</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeOwnerIds"><a href="Databrary.Solr.Document.html#solrVolumeOwnerIds"><span class="hs-identifier">solrVolumeOwnerIds</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Party.Types.html#Party"><span class="hs-identifier hs-type">Party</span></a><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeOwnerNames"><a href="Databrary.Solr.Document.html#solrVolumeOwnerNames"><span class="hs-identifier">solrVolumeOwnerNames</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrCitation"><a href="Databrary.Solr.Document.html#solrCitation"><span class="hs-identifier">solrCitation</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrCitationYear"><a href="Databrary.Solr.Document.html#solrCitationYear"><span class="hs-identifier">solrCitationYear</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int16</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrContainer"><a href="Databrary.Solr.Document.html#SolrContainer"><span class="hs-identifier">SolrContainer</span></a></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrName"><a href="Databrary.Solr.Document.html#solrName"><span class="hs-identifier">solrName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerTop"><a href="Databrary.Solr.Document.html#solrContainerTop"><span class="hs-identifier">solrContainerTop</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerDate"><a href="Databrary.Solr.Document.html#solrContainerDate"><span class="hs-identifier">solrContainerDate</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Time.html#MaskedDate"><span class="hs-identifier hs-type">MaskedDate</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRelease"><a href="Databrary.Solr.Document.html#solrRelease"><span class="hs-identifier">solrRelease</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Release.Types.html#Release"><span class="hs-identifier hs-type">Release</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrAsset"><a href="Databrary.Solr.Document.html#SolrAsset"><span class="hs-identifier">SolrAsset</span></a></a><span> </span><span class="hs-comment">-- Slot</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegment"><a href="Databrary.Solr.Document.html#solrSegment"><span class="hs-identifier">solrSegment</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegmentDuration"><a href="Databrary.Solr.Document.html#solrSegmentDuration"><span class="hs-identifier">solrSegmentDuration</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Offset.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrAssetId"><a href="Databrary.Solr.Document.html#solrAssetId"><span class="hs-identifier">solrAssetId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Asset.Types.html#Asset"><span class="hs-identifier hs-type">Asset</span></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrName"><a href="Databrary.Solr.Document.html#solrName"><span class="hs-identifier">solrName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrFormatId"><a href="Databrary.Solr.Document.html#solrFormatId"><span class="hs-identifier">solrFormatId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Format.Types.html#Format"><span class="hs-identifier hs-type">Format</span></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRelease"><a href="Databrary.Solr.Document.html#solrRelease"><span class="hs-identifier">solrRelease</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Release.Types.html#Release"><span class="hs-identifier hs-type">Release</span></a><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrExcerpt"><a href="Databrary.Solr.Document.html#SolrExcerpt"><span class="hs-identifier">SolrExcerpt</span></a></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegment"><a href="Databrary.Solr.Document.html#solrSegment"><span class="hs-identifier">solrSegment</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegmentDuration"><a href="Databrary.Solr.Document.html#solrSegmentDuration"><span class="hs-identifier">solrSegmentDuration</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Offset.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrAssetId"><a href="Databrary.Solr.Document.html#solrAssetId"><span class="hs-identifier">solrAssetId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Asset.Types.html#Asset"><span class="hs-identifier hs-type">Asset</span></a><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRelease"><a href="Databrary.Solr.Document.html#solrRelease"><span class="hs-identifier">solrRelease</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Release.Types.html#Release"><span class="hs-identifier hs-type">Release</span></a><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrRecord"><a href="Databrary.Solr.Document.html#SolrRecord"><span class="hs-identifier">SolrRecord</span></a></a><span> </span><span class="hs-comment">-- Slot</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegment"><a href="Databrary.Solr.Document.html#solrSegment"><span class="hs-identifier">solrSegment</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span>
</span><a name="line-135"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegmentDuration"><a href="Databrary.Solr.Document.html#solrSegmentDuration"><span class="hs-identifier">solrSegmentDuration</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Offset.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRecordId"><a href="Databrary.Solr.Document.html#solrRecordId"><span class="hs-identifier">solrRecordId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Record.Types.html#Record"><span class="hs-identifier hs-type">Record</span></a><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRecordCategoryId"><a href="Databrary.Solr.Document.html#solrRecordCategoryId"><span class="hs-identifier">solrRecordCategoryId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Category.Types.html#Category"><span class="hs-identifier hs-type">Category</span></a><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRecordMeasures"><a href="Databrary.Solr.Document.html#solrRecordMeasures"><span class="hs-identifier">solrRecordMeasures</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrRecordMeasures"><span class="hs-identifier hs-type">SolrRecordMeasures</span></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrRecordAge"><a href="Databrary.Solr.Document.html#solrRecordAge"><span class="hs-identifier">solrRecordAge</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Age.html#Age"><span class="hs-identifier hs-type">Age</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrTagId"><a href="Databrary.Solr.Document.html#SolrTagId"><span class="hs-identifier">SolrTagId</span></a></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrTagId"><a href="Databrary.Solr.Document.html#solrTagId"><span class="hs-identifier">solrTagId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Tag.Types.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrTagName"><a href="Databrary.Solr.Document.html#solrTagName"><span class="hs-identifier">solrTagName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Tag.Types.html#TagName"><span class="hs-identifier hs-type">TagName</span></a><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrTag"><a href="Databrary.Solr.Document.html#SolrTag"><span class="hs-identifier">SolrTag</span></a></a><span> </span><span class="hs-comment">-- Use</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegment"><a href="Databrary.Solr.Document.html#solrSegment"><span class="hs-identifier">solrSegment</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegmentDuration"><a href="Databrary.Solr.Document.html#solrSegmentDuration"><span class="hs-identifier">solrSegmentDuration</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Offset.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrTagId"><a href="Databrary.Solr.Document.html#solrTagId"><span class="hs-identifier">solrTagId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Tag.Types.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrTagName"><a href="Databrary.Solr.Document.html#solrTagName"><span class="hs-identifier">solrTagName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Tag.Types.html#TagName"><span class="hs-identifier hs-type">TagName</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrKeyword"><a href="Databrary.Solr.Document.html#solrKeyword"><span class="hs-identifier">solrKeyword</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Tag.Types.html#TagName"><span class="hs-identifier hs-type">TagName</span></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyId"><a href="Databrary.Solr.Document.html#solrPartyId"><span class="hs-identifier">solrPartyId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Party.Types.html#Party"><span class="hs-identifier hs-type">Party</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SolrComment"><a href="Databrary.Solr.Document.html#SolrComment"><span class="hs-identifier">SolrComment</span></a></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="solrId"><a href="Databrary.Solr.Document.html#solrId"><span class="hs-identifier">solrId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">BS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrVolumeId"><a href="Databrary.Solr.Document.html#solrVolumeId"><span class="hs-identifier">solrVolumeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Volume.Types.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrContainerId"><a href="Databrary.Solr.Document.html#solrContainerId"><span class="hs-identifier">solrContainerId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Container.Types.html#Container"><span class="hs-identifier hs-type">Container</span></a><span>
</span><a name="line-161"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegment"><a href="Databrary.Solr.Document.html#solrSegment"><span class="hs-identifier">solrSegment</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrSegment"><span class="hs-identifier hs-type">SolrSegment</span></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrSegmentDuration"><a href="Databrary.Solr.Document.html#solrSegmentDuration"><span class="hs-identifier">solrSegmentDuration</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Databrary.Model.Offset.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrCommentId"><a href="Databrary.Solr.Document.html#solrCommentId"><span class="hs-identifier">solrCommentId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Comment.Types.html#Comment"><span class="hs-identifier hs-type">Comment</span></a><span>
</span><a name="line-164"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrPartyId"><a href="Databrary.Solr.Document.html#solrPartyId"><span class="hs-identifier">solrPartyId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="Databrary.Model.Party.Types.html#Party"><span class="hs-identifier hs-type">Party</span></a><span>
</span><a name="line-165"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="solrBody"><a href="Databrary.Solr.Document.html#solrBody"><span class="hs-identifier">solrBody</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-operator">$</span><span class="hs-special">(</span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- force new decl group for splice:</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-identifier">solrToJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Solr.Document.html#SolrDocument"><span class="hs-identifier hs-type">SolrDocument</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">JSON</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Value</span><span>
</span><a name="line-171"></a><a name="solrToJSON"><a href="Databrary.Solr.Document.html#solrToJSON"><span class="hs-identifier">solrToJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-operator">$</span><span class="hs-special">(</span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mkToJSON</span></a><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fieldLabelModifier</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-char">'s'</span><span class="hs-glyph">:</span><span class="hs-char">'o'</span><span class="hs-glyph">:</span><span class="hs-char">'l'</span><span class="hs-glyph">:</span><span class="hs-char">'r'</span><span class="hs-glyph">:</span><a href="#local-1628719537"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">fromCamel</span></a><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-174"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">constructorTagModifier</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-char">'S'</span><span class="hs-glyph">:</span><span class="hs-char">'o'</span><span class="hs-glyph">:</span><span class="hs-char">'l'</span><span class="hs-glyph">:</span><span class="hs-char">'r'</span><span class="hs-glyph">:</span><a href="#local-1628719537"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">fromCamel</span></a><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">omitNothingFields</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-176"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sumEncoding</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TaggedObject</span></a><span>
</span><a name="line-177"></a><span>      </span><span class="hs-special">{</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tagFieldName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;content_type&quot;</span><span>
</span><a name="line-178"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">JTH</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">contentsFieldName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628719537"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;solrToJSON: contentsFieldName&quot;</span><span>
</span><a name="line-179"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-char">''SolrDocument)

fixToJSON :: SolrDocument -&gt; JSON.Value -&gt; JSON.Value
fixToJSON SolrRecord{} (JSON.Object o) = JSON.Object $
  maybe o (HM.union $ HM.delete k o) $ do
    JSON.Object m &lt;- HM.lookup k o
    return m
  where k = &quot;record_measures&quot;
fixToJSON _ j = j

instance JSON.ToJSON SolrDocument where
  toJSON s = fixToJSON s $ solrToJSON s
  -- TODO: toEncoding (and cleanup fixToJSON)
</span></pre></body></html>