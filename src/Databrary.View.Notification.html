<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, RecordWildCards #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Notification</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../Databrary-View-Notification.html#v:mailNotifications"><span class="hs-identifier hs-var">mailNotifications</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../Databrary-View-Notification.html#v:htmlNotification"><span class="hs-identifier hs-var">htmlNotification</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Builder</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSB</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSC</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">on</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TE</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TL</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TLE</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">Html5</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">H</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Blaze</span><span class="hs-operator">.</span><span class="hs-identifier">Html5</span><span class="hs-operator">.</span><span class="hs-identifier">Attributes</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HA</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Ops.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Ops</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Permission.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Permission</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Id-Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Id</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Party.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Party</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Volume-Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Volume</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Segment.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Segment</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Slot-Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Slot</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Tag-Types.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Tag</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Model-Notification.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Model</span><span class="hs-operator">.</span><span class="hs-identifier">Notification</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Service-Messages.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Service</span><span class="hs-operator">.</span><span class="hs-identifier">Messages</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-HTTP-Route.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">HTTP</span><span class="hs-operator">.</span><span class="hs-identifier">Route</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Action-Route.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Action</span><span class="hs-operator">.</span><span class="hs-identifier">Route</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-Controller-Paths.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Controller</span><span class="hs-operator">.</span><span class="hs-identifier">Paths</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="../Databrary-Controller-Party.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Controller</span><span class="hs-operator">.</span><span class="hs-identifier">Party</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="../Databrary-Controller-Volume.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Controller</span><span class="hs-operator">.</span><span class="hs-identifier">Volume</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="../Databrary-Controller-Slot.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Controller</span><span class="hs-operator">.</span><span class="hs-identifier">Slot</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="../Databrary-Controller-AssetSegment.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">Controller</span><span class="hs-operator">.</span><span class="hs-identifier">AssetSegment</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-Authorize.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Authorize</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Authorize.html#v:authorizeSiteTitle"><span class="hs-identifier hs-var">authorizeSiteTitle</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-Party.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Party</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Party.html#v:htmlPartyViewLink"><span class="hs-identifier hs-var">htmlPartyViewLink</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-Volume.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Volume</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Volume.html#v:htmlVolumeViewLink"><span class="hs-identifier hs-var">htmlVolumeViewLink</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-VolumeAccess.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">VolumeAccess</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessTitle"><span class="hs-identifier hs-var">volumeAccessTitle</span></a><span class="hs-special">,</span><span> </span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessPresetTitle"><span class="hs-identifier hs-var">volumeAccessPresetTitle</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-Container.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Container</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="../Databrary-View-Html.html"><span class="hs-identifier">Databrary</span><span class="hs-operator">.</span><span class="hs-identifier">View</span><span class="hs-operator">.</span><span class="hs-identifier">Html</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-identifier">mailLink</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.HTTP.Route.html#Route"><span class="hs-identifier hs-type">Route</span></a><span> </span><a href="#local-1629561061"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-1629561062"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1629561062"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">BSC</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">BSC</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-44"></a><a name="mailLink"><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier">mailLink</span></a></a><span> </span><a name="local-1629561063"><a href="#local-1629561063"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-1629561064"><a href="#local-1629561064"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1629561065"><a href="#local-1629561065"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TLE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">decodeLatin1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">BSB</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toLazyByteString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;https://databrary.org&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-Action-Route.html#v:actionURL"><span class="hs-identifier hs-var">actionURL</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-1629561063"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1629561064"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-identifier hs-var">Just</span><span class="hs-special">)</span><span> </span><a href="#local-1629561065"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Query</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-identifier">partyEditLink</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#ActionRoute"><span class="hs-identifier hs-type">ActionRoute</span></a><span> </span><a href="Databrary.Controller.Paths.html#PartyTarget"><span class="hs-identifier hs-type">PartyTarget</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Controller.Paths.html#PartyTarget"><span class="hs-identifier hs-type">PartyTarget</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1629561060"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Model.Party.Types.html#PartyRow"><span class="hs-identifier hs-type">PartyRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Model.Party.Types.html#PartyRow"><span class="hs-identifier hs-type">PartyRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1629561060"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-47"></a><a name="partyEditLink"><a href="../Databrary-View-Notification.html#v:partyEditLink"><span class="hs-identifier">partyEditLink</span></a></a><span> </span><a name="local-1629561066"><a href="#local-1629561066"><span class="hs-identifier">link</span></a></a><span> </span><a name="local-1629561067"><a href="#local-1629561067"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-1629561068"><a href="#local-1629561068"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561066"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="../Databrary-Controller-Party.html#v:viewPartyEdit"><span class="hs-identifier hs-var">viewPartyEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">on</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span> </span><a href="#local-1629561068"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1629561067"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Databrary.Controller.Paths.html#TargetProfile"><span class="hs-identifier hs-var">TargetProfile</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Databrary.Controller.Paths.html#TargetParty"><span class="hs-identifier hs-var">TargetParty</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span> </span><a href="#local-1629561068"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-identifier">mailNotification</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Service.Messages.html#Messages"><span class="hs-identifier hs-type">Messages</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-type">Notification</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-50"></a><a name="mailNotification"><a href="../Databrary-View-Notification.html#v:mailNotification"><span class="hs-identifier">mailNotification</span></a></a><span> </span><a name="local-1629561069"><a href="#local-1629561069"><span class="hs-identifier">msg</span></a></a><span> </span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-var">Notification</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1629561072"><span class="hs-identifier hs-var">notificationNotice</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-51"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAccountChange"><span class="hs-identifier hs-var">NoticeAccountChange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-52"></a><span>    </span><a href="#local-1629561092"><span class="hs-identifier hs-var">party'S</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; email or password has been changed. If you made this change, you may ignore this email. To review or update your account information, go to: &quot;</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-1629561076"><span class="hs-identifier hs-var">notificationParty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;account&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\nIf you did not make this change, please contact us immediately.&quot;</span><span>
</span><a name="line-55"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeRequest"><span class="hs-identifier hs-var">NoticeAuthorizeRequest</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-56"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; requested authorization from &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review the status of this request, go to: &quot;</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561094"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span>
</span><a name="line-58"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeGranted"><span class="hs-identifier hs-var">NoticeAuthorizeGranted</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-1629561106"><a href="#local-1629561106"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1629561078"><span class="hs-identifier hs-var">notificationPermission</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-60"></a><span>      </span><span class="hs-string">&quot;You have been authorized under &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, &quot;</span><span>
</span><a name="line-61"></a><span>      </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1629561106"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Databrary.Model.Permission.Types.html#PermissionNONE"><span class="hs-identifier hs-var">PermissionNONE</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;for group/lab-only access.&quot;</span><span>
</span><a name="line-62"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;as a Databrary &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Authorize.html#v:authorizeSiteTitle"><span class="hs-identifier hs-var">authorizeSiteTitle</span></a><span> </span><a href="#local-1629561106"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. \
      \Your authorization allows you to access all the shared data in Databrary. \
      \Our primary goal is to inspire you to reuse shared videos on Databrary to ask new questions outside the scope of the original study. \
      \You will also find illustrative video excerpts that you can use for teaching and to learn about other researchers' methods and procedures.\
      \\n\n\
      \Databrary's unique \&quot;active curation\&quot; functionality allows you to upload your videos as you collect them so that your data are backed up and preserved in our free, secure library, your videos are immediately available to you and your collaborators offsite, and your data are organized and ready for sharing. \
      \Your data will remain private and accessible only to your lab members and collaborators until you are ready to share with the Databrary community. \
      \When you are ready, sharing is as easy as clicking a button!\
      \\n\n\
      \You can use our template Databrary release form to obtain permission for sharing the data you collect from your participants, which can be found here: http://databrary.org/access/policies/release-template.html\n\
      \The release form can be added to new or existing IRB protocols. \
      \It is completely adaptable and can be customized to suit your needs. \
      \We also offer additional information and helpful tips about managing and sharing your video data in our User Guide: http://databrary.org/access/guide\n\
      \As soon as your protocol is amended to allow you to share data, you can start uploading your data from each new session. \
      \Don't wait until your study is complete to upload your videos. \
      \It's much easier to upload data after each data collection while your study is in progress!\
      \\n\n\
      \We are dedicated to providing assistance to the Databrary community. \
      \Please contact us at support@databrary.org with questions or for help getting started.\
      \\n&quot;</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-83"></a><span>      </span><span class="hs-string">&quot;Your authorization under &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; has been revoked. To review and apply for authorizations, go to: &quot;</span><span>
</span><a name="line-84"></a><span>      </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeExpiring"><span class="hs-identifier hs-var">NoticeAuthorizeExpiring</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-string">&quot;Your authorization under &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; will expire within a week. Please contact them and request that they renew your authorization.&quot;</span><span>
</span><a name="line-87"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeExpired"><span class="hs-identifier hs-var">NoticeAuthorizeExpired</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-string">&quot;Your authorization under &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; has expired. Please contact them and request that they renew your authorization.&quot;</span><span>
</span><a name="line-89"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildRequest"><span class="hs-identifier hs-var">NoticeAuthorizeChildRequest</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-90"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; has requested to be authorized through &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To approve or reject this authorization request, go to: &quot;</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-1629561076"><span class="hs-identifier hs-var">notificationParty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561093"><span class="hs-identifier hs-var">personq</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1629561075"><span class="hs-identifier hs-var">notificationAgent</span></a><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildGranted"><span class="hs-identifier hs-var">NoticeAuthorizeChildGranted</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-93"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561096"><span class="hs-identifier hs-var">granted</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; authorization to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561089"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this authorization, go to: &quot;</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561094"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildExpiring"><span class="hs-identifier hs-var">NoticeAuthorizeChildExpiring</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-96"></a><span>    </span><a href="#local-1629561092"><span class="hs-identifier hs-var">party'S</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; authorization will expire within a week. If you would like to renew their authorization, go to: &quot;</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561094"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildExpired"><span class="hs-identifier hs-var">NoticeAuthorizeChildExpired</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-99"></a><span>    </span><a href="#local-1629561092"><span class="hs-identifier hs-var">party'S</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; authorization has expired. If you would like to renew their authorization, go to: &quot;</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561095"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561094"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span>
</span><a name="line-101"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAssist"><span class="hs-identifier hs-var">NoticeVolumeAssist</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-102"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; requested assistance with your volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this request, go to: &quot;</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561098"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;assist&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeCreated"><span class="hs-identifier hs-var">NoticeVolumeCreated</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-105"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; created a volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, on &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561091"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; behalf. To review this volume, go to: &quot;</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolume"><span class="hs-identifier hs-var">viewVolume</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeSharing"><span class="hs-identifier hs-var">NoticeVolumeSharing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-108"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; changed your volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessPresetTitle"><span class="hs-identifier hs-var">volumeAccessPresetTitle</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Permission.Types.html#PermissionNONE"><span class="hs-identifier hs-var">PermissionNONE</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1629561099"><span class="hs-identifier hs-var">perm</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561098"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;access&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAccessOther"><span class="hs-identifier hs-var">NoticeVolumeAccessOther</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-111"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; set &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561091"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; access to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessTitle"><span class="hs-identifier hs-var">volumeAccessTitle</span></a><span> </span><a href="#local-1629561099"><span class="hs-identifier hs-var">perm</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; on your volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561098"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;access&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561094"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAccess"><span class="hs-identifier hs-var">NoticeVolumeAccess</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-114"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; set &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561091"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; access to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessTitle"><span class="hs-identifier hs-var">volumeAccessTitle</span></a><span> </span><a href="#local-1629561099"><span class="hs-identifier hs-var">perm</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; on your volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561098"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;access&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseSlot"><span class="hs-identifier hs-var">NoticeReleaseSlot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-117"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; set the release level of a folder in &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561082"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561100"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-119"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseAsset"><span class="hs-identifier hs-var">NoticeReleaseAsset</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-120"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; set the release level of a file in your volume (&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;) to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561082"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561100"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;asset&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><a href="#local-1629561081"><span class="hs-identifier hs-var">notificationAssetId</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-122"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseExcerpt"><span class="hs-identifier hs-var">NoticeReleaseExcerpt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-123"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; set the release level of a highlight in your volume (&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;) to &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561082"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561069"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review this change, go to: &quot;</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561101"><span class="hs-identifier hs-var">assetSegment</span></a><span>
</span><a name="line-125"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeExcerptVolume"><span class="hs-identifier hs-var">NoticeExcerptVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-126"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; created a highlight in your volume (&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;). To review this highlight, go to: &quot;</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561101"><span class="hs-identifier hs-var">assetSegment</span></a><span>
</span><a name="line-128"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeCommentVolume"><span class="hs-identifier hs-var">NoticeCommentVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-129"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; commented on your volume (&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;). To review or reply, go to: &quot;</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561102"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;#comment-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><a href="#local-1629561083"><span class="hs-identifier hs-var">notificationCommentId</span></a><span>
</span><a name="line-131"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeCommentReply"><span class="hs-identifier hs-var">NoticeCommentReply</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- high risk information disclosure of volume name</span><span>
</span><a name="line-132"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; replied to your comment on the volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;. To review or reply, go to: &quot;</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561102"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;#comment-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><a href="#local-1629561083"><span class="hs-identifier hs-var">notificationCommentId</span></a><span>
</span><a name="line-134"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeTagVolume"><span class="hs-identifier hs-var">NoticeTagVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-135"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; tagged the volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, with \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">TE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">decodeLatin1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagNameBS"><span class="hs-identifier hs-var">tagNameBS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagName"><span class="hs-identifier hs-var">tagName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561084"><span class="hs-identifier hs-var">notificationTag</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\&quot;. To review tags, go to: &quot;</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561102"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;tag&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Tag-Types.html#v:tagNameBS"><span class="hs-identifier hs-var">tagNameBS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagName"><span class="hs-identifier hs-var">tagName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561084"><span class="hs-identifier hs-var">notificationTag</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;#panel-tags&quot;</span><span>
</span><a name="line-137"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeSharedVolume"><span class="hs-identifier hs-var">NoticeSharedVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-138"></a><span>    </span><a href="#local-1629561087"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; shared the following volume, &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561097"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;, on Databrary. To review, go to: &quot;</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolume"><span class="hs-identifier hs-var">viewVolume</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-140"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeNewsletter"><span class="hs-identifier hs-var">NoticeNewsletter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-string">&quot;A new Databrary newsletter has been posted. Te see it, go to: http://databrary.org/news.html&quot;</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>  </span><a name="local-1629561085"><a href="#local-1629561085"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyRow"><span class="hs-identifier hs-var">partyRow</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Party-Types.html#v:accountParty"><span class="hs-identifier hs-var">accountParty</span></a><span> </span><a href="#local-1629561071"><span class="hs-identifier hs-var">notificationTarget</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-1629561086"><a href="#local-1629561086"><span class="hs-identifier">person</span></a></a><span> </span><a name="local-1629561103"><a href="#local-1629561103"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">on</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span> </span><a href="#local-1629561103"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="Databrary.Ops.html#%3F%3E"><span class="hs-operator hs-var">?&gt;</span></a><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Party.html#v:partyName"><span class="hs-identifier hs-var">partyName</span></a><span> </span><a href="#local-1629561103"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>  </span><a name="local-1629561087"><a href="#local-1629561087"><span class="hs-identifier">agent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;You&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1629561086"><span class="hs-identifier hs-var">person</span></a><span> </span><a href="#local-1629561075"><span class="hs-identifier hs-var">notificationAgent</span></a><span>
</span><a name="line-146"></a><span>  </span><a name="local-1629561088"><a href="#local-1629561088"><span class="hs-identifier">partyp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561086"><span class="hs-identifier hs-var">person</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-1629561076"><span class="hs-identifier hs-var">notificationParty</span></a><span>
</span><a name="line-147"></a><span>  </span><a name="local-1629561089"><a href="#local-1629561089"><span class="hs-identifier">party</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;you&quot;</span><span> </span><a href="#local-1629561088"><span class="hs-identifier hs-var">partyp</span></a><span>
</span><a name="line-148"></a><span>  </span><a name="local-1629561090"><a href="#local-1629561090"><span class="hs-identifier">party'sOr</span></a></a><span> </span><a name="local-1629561104"><a href="#local-1629561104"><span class="hs-identifier">your</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-1629561104"><span class="hs-identifier hs-var">your</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;'s&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1629561088"><span class="hs-identifier hs-var">partyp</span></a><span>
</span><a name="line-149"></a><span>  </span><a name="local-1629561091"><a href="#local-1629561091"><span class="hs-identifier">party's</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561090"><span class="hs-identifier hs-var">party'sOr</span></a><span> </span><span class="hs-string">&quot;your&quot;</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-1629561092"><a href="#local-1629561092"><span class="hs-identifier">party'S</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561090"><span class="hs-identifier hs-var">party'sOr</span></a><span> </span><span class="hs-string">&quot;Your&quot;</span><span>
</span><a name="line-151"></a><span>  </span><a name="local-1629561093"><a href="#local-1629561093"><span class="hs-identifier">personq</span></a></a><span> </span><a name="local-1629561105"><a href="#local-1629561105"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;party&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561105"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>  </span><a name="local-1629561094"><a href="#local-1629561094"><span class="hs-identifier">partyq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561093"><span class="hs-identifier hs-var">personq</span></a><span> </span><a href="#local-1629561076"><span class="hs-identifier hs-var">notificationParty</span></a><span>
</span><a name="line-153"></a><span>  </span><a name="local-1629561095"><a href="#local-1629561095"><span class="hs-identifier">partyEdit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:partyEditLink"><span class="hs-identifier hs-var">partyEditLink</span></a><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="#local-1629561085"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-154"></a><span>  </span><a name="local-1629561096"><a href="#local-1629561096"><span class="hs-identifier">granted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;revoked&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-string">&quot;granted&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1629561078"><span class="hs-identifier hs-var">notificationPermission</span></a><span>
</span><a name="line-155"></a><span>  </span><a name="local-1629561097"><a href="#local-1629561097"><span class="hs-identifier">volume</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&lt;VOLUME&gt;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromStrict</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeName"><span class="hs-identifier hs-var">volumeName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span>
</span><a name="line-156"></a><span>  </span><a name="local-1629561098"><a href="#local-1629561098"><span class="hs-identifier">volumeEdit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolumeEdit"><span class="hs-identifier hs-var">viewVolumeEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>  </span><a name="local-1629561099"><a href="#local-1629561099"><span class="hs-identifier">perm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="Databrary.Model.Permission.Types.html#PermissionNONE"><span class="hs-identifier hs-var">PermissionNONE</span></a><span> </span><a href="#local-1629561078"><span class="hs-identifier hs-var">notificationPermission</span></a><span>
</span><a name="line-158"></a><span>  </span><a name="local-1629561100"><a href="#local-1629561100"><span class="hs-identifier">slot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Databrary.Model.Slot.Types.html#SlotId"><span class="hs-identifier hs-var">SlotId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="#local-1629561079"><span class="hs-identifier hs-var">notificationContainerId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-Model-Segment.html#v:fullSegment"><span class="hs-identifier hs-var">fullSegment</span></a><span> </span><a href="#local-1629561080"><span class="hs-identifier hs-var">notificationSegment</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>  </span><a name="local-1629561101"><a href="#local-1629561101"><span class="hs-identifier">assetSegment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-AssetSegment.html#v:viewAssetSegment"><span class="hs-identifier hs-var">viewAssetSegment</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561100"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="#local-1629561081"><span class="hs-identifier hs-var">notificationAssetId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-160"></a><span>  </span><a name="local-1629561102"><a href="#local-1629561102"><span class="hs-identifier">slotVolume</span></a></a><span>
</span><a name="line-161"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-1629561079"><span class="hs-identifier hs-var">notificationContainerId</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561100"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolume"><span class="hs-identifier hs-var">viewVolume</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561077"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-identifier">mailNotifications</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Service.Messages.html#Messages"><span class="hs-identifier hs-type">Messages</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-type">Notification</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-165"></a><a name="mailNotifications"><a href="../Databrary-View-Notification.html#v:mailNotifications"><span class="hs-identifier">mailNotifications</span></a></a><span> </span><a name="local-1629561107"><a href="#local-1629561107"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-1629561108"><a href="#local-1629561108"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-var">Notification</span></a><span class="hs-special">{</span><span> </span><a href="../Databrary-Model-Notification-Types.html#v:notificationTarget"><span class="hs-identifier hs-var">notificationTarget</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1629561109"><a href="#local-1629561109"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromChunks</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Dear &quot;</span><span class="hs-special">,</span><span> </span><a href="../Databrary-Model-Party.html#v:partyName"><span class="hs-identifier hs-var">partyName</span></a><span> </span><a href="#local-1629561110"><span class="hs-identifier hs-var">target</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;,\n&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-167"></a><span>  </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1629561111"><a href="#local-1629561111"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">cons</span><span class="hs-special">`</span><span> </span><a href="../Databrary-View-Notification.html#v:mailNotification"><span class="hs-identifier hs-var">mailNotification</span></a><span> </span><a href="#local-1629561107"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-1629561111"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">snoc</span><span class="hs-special">`</span><span> </span><span class="hs-char">'\n'</span><span class="hs-special">)</span><span> </span><a href="#local-1629561108"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;\nYou can change your notification settings or unsubscribe here: &quot;</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="../Databrary-View-Notification.html#v:partyEditLink"><span class="hs-identifier hs-var">partyEditLink</span></a><span> </span><a href="../Databrary-View-Notification.html#v:mailLink"><span class="hs-identifier hs-var">mailLink</span></a><span> </span><a href="#local-1629561110"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-1629561110"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;notifications&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">snoc</span><span class="hs-special">`</span><span> </span><span class="hs-char">'\n'</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-171"></a><span>  </span><a name="local-1629561110"><a href="#local-1629561110"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyRow"><span class="hs-identifier hs-var">partyRow</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Party-Types.html#v:accountParty"><span class="hs-identifier hs-var">accountParty</span></a><span> </span><a href="#local-1629561109"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">htmlNotification</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Databrary.Service.Messages.html#Messages"><span class="hs-identifier hs-type">Messages</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-type">Notification</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">H</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Html</span><span>
</span><a name="line-174"></a><a name="htmlNotification"><a href="../Databrary-View-Notification.html#v:htmlNotification"><span class="hs-identifier">htmlNotification</span></a></a><span> </span><a name="local-1629561112"><a href="#local-1629561112"><span class="hs-identifier">msg</span></a></a><span> </span><a href="Databrary.Model.Notification.Types.html#Notification"><span class="hs-identifier hs-var">Notification</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1629561115"><span class="hs-identifier hs-var">notificationNotice</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-175"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAccountChange"><span class="hs-identifier hs-var">NoticeAccountChange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-176"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; changed &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561134"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;account&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;account information&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-178"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeRequest"><span class="hs-identifier hs-var">NoticeAuthorizeRequest</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-179"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; requested &quot;</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; from &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561132"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-181"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeGranted"><span class="hs-identifier hs-var">NoticeAuthorizeGranted</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-string">&quot;Your &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; under &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;yourself&quot;</span><span> </span><span class="hs-special">(</span><a href="#local-1629561129"><span class="hs-identifier hs-var">person</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; has been &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561140"><span class="hs-identifier hs-var">granted</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-184"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeExpiring"><span class="hs-identifier hs-var">NoticeAuthorizeExpiring</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-string">&quot;Your &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; through &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561132"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; will expire soon.&quot;</span><span>
</span><a name="line-186"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeExpired"><span class="hs-identifier hs-var">NoticeAuthorizeExpired</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-string">&quot;Your &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; through &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561132"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; is expired.&quot;</span><span>
</span><a name="line-188"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildRequest"><span class="hs-identifier hs-var">NoticeAuthorizeChildRequest</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-189"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; requested &quot;</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561136"><span class="hs-identifier hs-var">personq</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1629561118"><span class="hs-identifier hs-var">notificationAgent</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; from &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561132"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-191"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildGranted"><span class="hs-identifier hs-var">NoticeAuthorizeChildGranted</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-192"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561140"><span class="hs-identifier hs-var">granted</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561132"><span class="hs-identifier hs-var">party</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-194"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildExpiring"><span class="hs-identifier hs-var">NoticeAuthorizeChildExpiring</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-195"></a><span>    </span><a href="#local-1629561135"><span class="hs-identifier hs-var">party'S</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; will expire soon.&quot;</span><span>
</span><a name="line-196"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeAuthorizeChildExpired"><span class="hs-identifier hs-var">NoticeAuthorizeChildExpired</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-197"></a><span>    </span><a href="#local-1629561135"><span class="hs-identifier hs-var">party'S</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561139"><span class="hs-identifier hs-var">partyEdit</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;grant&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;authorization&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; is expired.&quot;</span><span>
</span><a name="line-198"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAssist"><span class="hs-identifier hs-var">NoticeVolumeAssist</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-199"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; requested &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561142"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;assist&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;assistance&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; with &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-200"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeCreated"><span class="hs-identifier hs-var">NoticeVolumeCreated</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-201"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; created &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; on &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561134"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; behalf.&quot;</span><span>
</span><a name="line-202"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeSharing"><span class="hs-identifier hs-var">NoticeVolumeSharing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-203"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; changed &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessPresetTitle"><span class="hs-identifier hs-var">volumeAccessPresetTitle</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Permission.Types.html#PermissionNONE"><span class="hs-identifier hs-var">PermissionNONE</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1629561143"><span class="hs-identifier hs-var">perm</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-205"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAccessOther"><span class="hs-identifier hs-var">NoticeVolumeAccessOther</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-206"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; set &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561134"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561142"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;access&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1629561137"><span class="hs-identifier hs-var">partyq</span></a><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;access&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessTitle"><span class="hs-identifier hs-var">volumeAccessTitle</span></a><span> </span><a href="#local-1629561143"><span class="hs-identifier hs-var">perm</span></a><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; on &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-208"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeVolumeAccess"><span class="hs-identifier hs-var">NoticeVolumeAccess</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-209"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; set &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561134"><span class="hs-identifier hs-var">party's</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561142"><span class="hs-identifier hs-var">volumeEdit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;page&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;access&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;access&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-VolumeAccess.html#v:volumeAccessTitle"><span class="hs-identifier hs-var">volumeAccessTitle</span></a><span> </span><a href="#local-1629561143"><span class="hs-identifier hs-var">perm</span></a><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; on &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-211"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseSlot"><span class="hs-identifier hs-var">NoticeReleaseSlot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-212"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; set a &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561138"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561144"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;folder&quot;</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561125"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-214"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseAsset"><span class="hs-identifier hs-var">NoticeReleaseAsset</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-215"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; set a &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561138"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561144"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;asset&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><a href="#local-1629561124"><span class="hs-identifier hs-var">notificationAssetId</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;file&quot;</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561125"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-217"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeReleaseExcerpt"><span class="hs-identifier hs-var">NoticeReleaseExcerpt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-218"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; set a &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561145"><span class="hs-identifier hs-var">assetSegment</span></a><span> </span><span class="hs-string">&quot;highlight&quot;</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Container.html#v:releaseTitle"><span class="hs-identifier hs-var">releaseTitle</span></a><span> </span><a href="#local-1629561125"><span class="hs-identifier hs-var">notificationRelease</span></a><span> </span><a href="#local-1629561112"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-220"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeExcerptVolume"><span class="hs-identifier hs-var">NoticeExcerptVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-221"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; created a &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561145"><span class="hs-identifier hs-var">assetSegment</span></a><span> </span><span class="hs-string">&quot;highlight&quot;</span><span>
</span><a name="line-222"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-223"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeCommentVolume"><span class="hs-identifier hs-var">NoticeCommentVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-224"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1629561146"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;#comment-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toValue</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Id-Types.html#v:unId"><span class="hs-identifier hs-var">unId</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561126"><span class="hs-identifier hs-var">notificationCommentId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;commented&quot;</span><span>
</span><a name="line-225"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; on &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-226"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeCommentReply"><span class="hs-identifier hs-var">NoticeCommentReply</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-227"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1629561146"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;#comment-&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toValue</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Id-Types.html#v:unId"><span class="hs-identifier hs-var">unId</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561126"><span class="hs-identifier hs-var">notificationCommentId</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;replied&quot;</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; to your comment on &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-229"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeTagVolume"><span class="hs-identifier hs-var">NoticeTagVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-230"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1629561146"><span class="hs-identifier hs-var">slotVolume</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;tag&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Tag-Types.html#v:tagNameBS"><span class="hs-identifier hs-var">tagNameBS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagName"><span class="hs-identifier hs-var">tagName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561127"><span class="hs-identifier hs-var">notificationTag</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;#panel-tags&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;tagged&quot;</span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; with &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">em</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="../Databrary-View-Html.html#v:byteStringHtml"><span class="hs-identifier hs-var">byteStringHtml</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagNameBS"><span class="hs-identifier hs-var">tagNameBS</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Tag-Types.html#v:tagName"><span class="hs-identifier hs-var">tagName</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561127"><span class="hs-identifier hs-var">notificationTag</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-232"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeSharedVolume"><span class="hs-identifier hs-var">NoticeSharedVolume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-233"></a><span>    </span><a href="#local-1629561130"><span class="hs-identifier hs-var">agent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; shared &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1629561141"><span class="hs-identifier hs-var">volume</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-234"></a><span>  </span><a href="Databrary.Model.Notification.Notice.html#NoticeNewsletter"><span class="hs-identifier hs-var">NoticeNewsletter</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-string">&quot;A new &quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">a</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.!</span><span> </span><span class="hs-identifier hs-var">HA</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">href</span><span> </span><span class="hs-string">&quot;//databrary.org/news.html&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;Databrary newsletter&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot; has been posted.&quot;</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>  </span><a name="local-1629561128"><a href="#local-1629561128"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyRow"><span class="hs-identifier hs-var">partyRow</span></a><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Party-Types.html#v:accountParty"><span class="hs-identifier hs-var">accountParty</span></a><span> </span><a href="#local-1629561114"><span class="hs-identifier hs-var">notificationTarget</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>  </span><a name="local-1629561129"><a href="#local-1629561129"><span class="hs-identifier">person</span></a></a><span> </span><a name="local-1629561147"><a href="#local-1629561147"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">on</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span> </span><a href="#local-1629561147"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="Databrary.Ops.html#%3F%3E"><span class="hs-operator hs-var">?&gt;</span></a><span> </span><a href="../Databrary-View-Party.html#v:htmlPartyViewLink"><span class="hs-identifier hs-var">htmlPartyViewLink</span></a><span> </span><a href="#local-1629561147"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Query</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>  </span><a name="local-1629561130"><a href="#local-1629561130"><span class="hs-identifier">agent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;You&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1629561129"><span class="hs-identifier hs-var">person</span></a><span> </span><a href="#local-1629561118"><span class="hs-identifier hs-var">notificationAgent</span></a><span>
</span><a name="line-240"></a><span>  </span><a name="local-1629561131"><a href="#local-1629561131"><span class="hs-identifier">partyp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">on</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span> </span><a href="#local-1629561118"><span class="hs-identifier hs-var">notificationAgent</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span> </span><a href="Databrary.Ops.html#%3F%3E"><span class="hs-operator hs-var">?&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1629561129"><span class="hs-identifier hs-var">person</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span>
</span><a name="line-241"></a><span>  </span><a name="local-1629561132"><a href="#local-1629561132"><span class="hs-identifier">party</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;you&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;themselves&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1629561131"><span class="hs-identifier hs-var">partyp</span></a><span>
</span><a name="line-242"></a><span>  </span><a name="local-1629561133"><a href="#local-1629561133"><span class="hs-identifier">party'sOr</span></a></a><span> </span><a name="local-1629561148"><a href="#local-1629561148"><span class="hs-identifier">your</span></a></a><span> </span><a name="local-1629561149"><a href="#local-1629561149"><span class="hs-identifier">their</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-1629561148"><span class="hs-identifier hs-var">your</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-1629561149"><span class="hs-identifier hs-var">their</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-string">&quot;'s&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1629561131"><span class="hs-identifier hs-var">partyp</span></a><span>
</span><a name="line-243"></a><span>  </span><a name="local-1629561134"><a href="#local-1629561134"><span class="hs-identifier">party's</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561133"><span class="hs-identifier hs-var">party'sOr</span></a><span> </span><span class="hs-string">&quot;your&quot;</span><span> </span><span class="hs-string">&quot;their own&quot;</span><span>
</span><a name="line-244"></a><span>  </span><a name="local-1629561135"><a href="#local-1629561135"><span class="hs-identifier">party'S</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561133"><span class="hs-identifier hs-var">party'sOr</span></a><span> </span><span class="hs-string">&quot;Your&quot;</span><span> </span><span class="hs-string">&quot;Their own&quot;</span><span>
</span><a name="line-245"></a><span>  </span><a name="local-1629561136"><a href="#local-1629561136"><span class="hs-identifier">personq</span></a></a><span> </span><a name="local-1629561150"><a href="#local-1629561150"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;party&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BSC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="../Databrary-Model-Party-Types.html#v:partyId"><span class="hs-identifier hs-var">partyId</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561150"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>  </span><a name="local-1629561137"><a href="#local-1629561137"><span class="hs-identifier">partyq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561136"><span class="hs-identifier hs-var">personq</span></a><span> </span><a href="#local-1629561119"><span class="hs-identifier hs-var">notificationParty</span></a><span>
</span><a name="line-247"></a><span>  </span><a name="local-1629561138"><a href="#local-1629561138"><span class="hs-identifier">link</span></a></a><span> </span><a name="local-1629561151"><a href="#local-1629561151"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-1629561152"><a href="#local-1629561152"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1629561153"><a href="#local-1629561153"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-1629561154"><a href="#local-1629561154"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">a</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.!</span><span> </span><a href="../Databrary-View-Html.html#v:actionLink"><span class="hs-identifier hs-var">actionLink</span></a><span> </span><a href="#local-1629561151"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-1629561152"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-identifier hs-var">Just</span><span class="hs-special">)</span><span> </span><a href="#local-1629561153"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Query</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1629561154"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-248"></a><span>  </span><a name="local-1629561139"><a href="#local-1629561139"><span class="hs-identifier">partyEdit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../Databrary-View-Notification.html#v:partyEditLink"><span class="hs-identifier hs-var">partyEditLink</span></a><span> </span><a href="#local-1629561138"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-1629561128"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-249"></a><span>  </span><a name="local-1629561140"><a href="#local-1629561140"><span class="hs-identifier">granted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;revoked&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-string">&quot;granted&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1629561121"><span class="hs-identifier hs-var">notificationPermission</span></a><span>
</span><a name="line-250"></a><span>  </span><a name="local-1629561141"><a href="#local-1629561141"><span class="hs-identifier">volume</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&lt;VOLUME&gt;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1629561155"><a href="#local-1629561155"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../Databrary-View-Volume.html#v:htmlVolumeViewLink"><span class="hs-identifier hs-var">htmlVolumeViewLink</span></a><span> </span><a href="#local-1629561155"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Query</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span>
</span><a name="line-251"></a><span>  </span><a name="local-1629561142"><a href="#local-1629561142"><span class="hs-identifier">volumeEdit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561138"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolumeEdit"><span class="hs-identifier hs-var">viewVolumeEdit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>  </span><a name="local-1629561143"><a href="#local-1629561143"><span class="hs-identifier">perm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="Databrary.Model.Permission.Types.html#PermissionNONE"><span class="hs-identifier hs-var">PermissionNONE</span></a><span> </span><a href="#local-1629561121"><span class="hs-identifier hs-var">notificationPermission</span></a><span>
</span><a name="line-253"></a><span>  </span><a name="local-1629561144"><a href="#local-1629561144"><span class="hs-identifier">slot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Databrary.Model.Slot.Types.html#SlotId"><span class="hs-identifier hs-var">SlotId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="#local-1629561122"><span class="hs-identifier hs-var">notificationContainerId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-Model-Segment.html#v:fullSegment"><span class="hs-identifier hs-var">fullSegment</span></a><span> </span><a href="#local-1629561123"><span class="hs-identifier hs-var">notificationSegment</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>  </span><a name="local-1629561145"><a href="#local-1629561145"><span class="hs-identifier">assetSegment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1629561138"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="../Databrary-Controller-AssetSegment.html#v:viewAssetSegment"><span class="hs-identifier hs-var">viewAssetSegment</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561144"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="#local-1629561124"><span class="hs-identifier hs-var">notificationAssetId</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-255"></a><span>  </span><a name="local-1629561146"><a href="#local-1629561146"><span class="hs-identifier">slotVolume</span></a></a><span> </span><a name="local-1629561156"><a href="#local-1629561156"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-1629561157"><a href="#local-1629561157"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">a</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.!</span><span> </span><span class="hs-identifier hs-var">HA</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">href</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-1629561122"><span class="hs-identifier hs-var">notificationContainerId</span></a><span>
</span><a name="line-256"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="../Databrary-View-Html.html#v:actionValue"><span class="hs-identifier hs-var">actionValue</span></a><span> </span><a href="../Databrary-Controller-Slot.html#v:viewSlot"><span class="hs-identifier hs-var">viewSlot</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">,</span><span> </span><a href="#local-1629561144"><span class="hs-identifier hs-var">slot</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1629561156"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">BSC</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">BSC</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561157"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-257"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="../Databrary-View-Html.html#v:actionValue"><span class="hs-identifier hs-var">actionValue</span></a><span> </span><a href="../Databrary-Controller-Volume.html#v:viewVolume"><span class="hs-identifier hs-var">viewVolume</span></a><span> </span><span class="hs-special">(</span><a href="Databrary.Action.Route.html#HTML"><span class="hs-identifier hs-var">HTML</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier hs-var">noId</span></a><span> </span><a href="../Databrary-Model-Volume-Types.html#v:volumeId"><span class="hs-identifier hs-var">volumeId</span></a><span> </span><a href="#local-1629561120"><span class="hs-identifier hs-var">notificationVolume</span></a><span class="hs-special">)</span><span> </span><a href="#local-1629561156"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-1629561157"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">noId</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Id.Types.html#IdType"><span class="hs-identifier hs-type">IdType</span></a><span> </span><a href="#local-1629561059"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><a href="#local-1629561059"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-260"></a><a name="noId"><a href="../Databrary-View-Notification.html#v:noId"><span class="hs-identifier">noId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Databrary.Model.Id.Types.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a></pre></body></html>